<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>API</title>

    <link rel="stylesheet" href="../bootstrap-4.0.0-alpha.6-dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="../main.css">

</head>
    <body>
        <div class="container">
            <div class="col-12">
                <h4 class="center">CO600 Project Corpus</h4>
                <h5 class="center">API</h5>
                
                <div class="row">
                    <div class="col-12">
                        <div class="wrapper">
                            <p>Our REST API provides a resourceful interface to our devices, the areas they're in and all the datapoint measurements associated with them.</p>
                            <p>To build the RESTful API we use a combination of Laravel's inbuilt API features to setup the core framework. We then use a resource transformer package provided by <a href="https://thephpleague.com/">The PHPLeague</a> that allows us to transform our models into resources with additional features. These features include meeting the criteria of the JSON response standard 'JSONAPI', providing users with a documented standard to understand our responses faster.</p>
                            <p>The data is split between different types; readings, 'still heres' and errors. As such there is a timeseries measurement (or table as known in MySQL) for each type in our InfluxDB database. A more relational structure is adopted by storing devices and areas in a MySQL database.</p>
                            <p>We also have a sixth model which we use and is the basis of statistics. This model applies arregates on the readings to provide statistics such as the average reading, the amount of readings and more.</p>
                            <p>The relational structure of MySQL is used to allow us to have IDs for devices and apply them as tags on the timeseries datapoints. It also allows us to provide a relation of many devices to one area to provide more structure by grouping the devices. The areas can then have a parent area to provide endless recursive grouping.</p>
                            <p>Each of the six models act as a basis of an endpoint. We provide indexes and show, that provide a list of all data or data from a specific ID. For example, <code>/devices</code> returning a list of device data and <code>/devices/abc1</code> returning data for device "abc1".</p>
                            <p>For the InfluxDB measurement endpoints we also provide a series of different time interval groupings such as daily, monthly and yearly. This allows the many datapoints to be grouped and averaged to better understand the data over a longer period of time.</p>
                            <p>To filter out the measurements per device and then group further to areas, we provide subresource endpoints such as <code>/device/abc1/reading</code>, which would provide all readings belonging to device "abc1".</p>
                            <p>Using Laravel's migration feature we allow the MySQL schema structure to be built and set up with a single command. This also allows for easy additions in the future.</p>
                            <p>For testing, we use a combination of Laravel's Seeders and Factories to create fake data that then allows us to test whether the endpoints are bringing back that data succesfully. For the tests themselves, we use PHPUnit and Laravel's helpers to call the endpoints and check the responses.</p>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-12">
                        <ul class="list-group">
                            <li class="list-group-item"><a href="../api/app/Models/Area.php" target="_blank">Area.php</a></li>
                            <li class="list-group-item"><a href="../api/app/Models/Device.php" target="_blank">Device.php</a></li>
                            <li class="list-group-item"><a href="../api/app/Models/Error.php" target="_blank">Error.php</a></li>
                            <li class="list-group-item"><a href="../api/app/Models/Reading.php" target="_blank">Reading.php</a></li>
                            <li class="list-group-item"><a href="../api/app/Models/Stat.php" target="_blank">Stat.php</a></li>
                            <li class="list-group-item"><a href="../api/app/Models/StillHere.php" target="_blank">StillHere.php</a></li>
                            <li class="list-group-item"><a href="../api/app/Http/Controllers/AreaController.php" target="_blank">AreaController.php</a></li>
                            <li class="list-group-item"><a href="../api/app/Http/Controllers/DeviceController.php" target="_blank">DeviceController.php</a></li>
                            <li class="list-group-item"><a href="../api/app/Http/Controllers/ErrorController.php" target="_blank">ErrorController.php</a></li>
                            <li class="list-group-item"><a href="../api/app/Http/Controllers/ReadingController.php" target="_blank">ReadingController.php</a></li>
                            <li class="list-group-item"><a href="../api/app/Http/Controllers/StatController.php" target="_blank">StatController.php</a></li>
                            <li class="list-group-item"><a href="../api/app/Http/Controllers/StillHereController.php" target="_blank">StillHereController.php</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <footer class="footer">
            <div class="container">&copy; CO600 Flood Watch 2018</div>
        </footer>
    </body>
</html>